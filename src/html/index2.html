<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Car Price Distribution</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="testchart.js" type="module" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <body>
        <div id="my_dataviz"></div>
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                Select Brands
            </button>
            <ul class="dropdown-menu" id="brandDropdown" aria-labelledby="dropdownMenuButton">
                <!-- Brands will be added here -->
            </ul>
        </div>
    
        <script type="module">
            import { drawGraph } from './testchart.js';
            import { getFilteredData } from './filteredData.js';
        
            async function populateBrandDropdown() {
                const data = await getFilteredData({});
                const brands = [...new Set(data.map(item => item.brand))];
        
                const dropdown = document.getElementById('brandDropdown');
                brands.forEach(brand => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="${brand}" id="${brand}">
                            <label class="form-check-label" for="${brand}">
                                ${brand}
                            </label>
                        </div>
                    `;
                    dropdown.appendChild(li);
    
                    // Add an event listener to the checkbox
                    li.querySelector('input').addEventListener('change', () => {
                        // Get all selected brands
                        const selectedBrands = Array.from(dropdown.querySelectorAll('input:checked')).map(input => input.value);
                        // Redraw the graph with the selected brands
                        drawGraph(selectedBrands); // Update the price range as needed
                    });
                });
            }
    
            populateBrandDropdown();
        </script>
    </body>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>  

</html>